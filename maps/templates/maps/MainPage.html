{% extends 'base.html' %}

{% load static %}
{% block css %}

<link rel="stylesheet" type="text/css" href="{% static 'maps/stylesheets/MainPage.css' %}">

<link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/themes/base/jquery-ui.css" />
<link rel="stylesheet" href="{% static 'maps/stylesheets/style.css' %}">

<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>
<script src="{% static 'maps/assets/js/d3.js' %}"></script>
{% endblock %}

<!-- body -->
{% block body %}
<div class="main-wrapper">
    <!-- section-1 -->
    <div class="section section-1">
        <div class="section-1-background">
            <video style="position: relative;" id="videobcg" preload="auto" autoplay="true" loop="loop" muted="muted" volume="0">
                <source src="{% static 'maps/assets/video/korea.mp4' %}" type="video/mp4">
            </video>
        </div>
        <div class = "section-content">
          <span id="animationSandbox" style="display: block;" class="heartBeat">
             <p style="font-size: 10vw" class="site__title mega">Travel To Korea</p>
          </span>
        </div>
    </div>


    <div id="app" class="section section-2" style="height:100%">
        <div class="section-content">
            <div id="left1"  >
                <div class="layer" >
                    <table width="100%" height="100%" class="leftTable">
                        <tr>
                            <td>
                                <div id="container" class="mapContainer">
                                    <div id="radio">
                                        <span class="title" style="color:black">지명표시</span>
                                        <input type="radio" id="radio1" name="radio" value="on" checked><label for="radio1">On</label>
                                        <input type="radio" id="radio2" name="radio" value="off"><label for="radio2">Off</label>
                                    </div>
                                </div>
                            </td>

                        </tr>
                    </table>
                </div>
            </div>


            <div id="right1" >

                <table width="100%" class="rightTable" >
                    <colgroup>
                        <col width="8%">
                        <col width="8%">
                        <col width="8%">
                        <col width="8%">
                        <col width="8%">
                        <col width="8%">
                        <col width="8%">
                        <col width="8%">
                    </colgroup>
                    <thead>
                    <tr height="30px">
                        <div class="checkbox">
                            <th class="rt1Row1Col"> <input type="checkbox" @click="checkAll" v-model="allSelected">전체</th>
                            <th class="rt1Row2Col" v-for="i in kategorie"><input type="checkbox" v-model="chk_info" v-on:click="check(i.id)" :value="i.name">[[i.name]]</th>
                        </div>
                    </tr>
                    <tr height="30px" >
                        <th colspan="4" class="rt2Row1Col">
                            <select id="region" name="region" v-on:change="changeRegion()">
                                <option value="all">전체보기</option>
                                [[selectedlist]]
                                {% for i in value %}
                                <option value="{{i.code}}">{{i.name}}</option>
                                {% endfor %}
                            </select>
                        </th>
                        <th colspan="4" class="rt2Row2Col">
                            <select id="sigungu" v-on:change="changeSigungu()">
                                <option  selected disabled hidden>시군구 선택</option>
                                <option v-for="list in selectedlist" id = "listsigungu" :value="list.code">[[list.name]]</option>
                            </select>
                        </th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td colspan="8" class="rt3Row1Col">
                            <p>[[chk_info]]</p>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="8" height="465">
                            <div style="overflow-y:scroll; height:100%; width:100%">
                                <p v-for="list in travelList">[[list]]</p>
                            </div>
                        </td>
                    </tr>

                    </tbody>

                </table>
            </div>
        </div>
    </div>

    <div class="section section-3">
        <div class="section-content">
            <div id="left2" >
                <p style="text-align: left; font-size: 25px">왼쪽</p>

            </div>

            <div id="right2" >
                <p style="text-align: left; font-size: 25px">오른쪽</p>

            </div>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>

var app = new Vue({
    el: '#app',
    delimiters: ['[[', ']]'],
    data: {
            tmplist:[],
            selectedlist:[],
            selectedoption:[],
            travelList:[],
            allSelected:false,
            areacode:'',
            sigungucode:'',
            chk_info:[],
            flag:true,
            kategorie:[
                { id : '12', name : '관광'},
                { id : '14', name : '문화'},
                { id : '15', name : '축제'},
                { id : '28', name : '야외'},
                { id : '32', name : '숙박'},
                { id : '38', name : '쇼핑'},
                { id : '39', name : '음식'}
            ],
    },
    methods:{
        <!--대분류 선택시-->
        changeRegion : function(){
            var Select = document.getElementById("region");
            this.areacode=Select.value;
            let base_URL = "http://api.visitkorea.or.kr/openapi/service/rest/KorService/areaCode?ServiceKey=tG2pbhauvACu6IO20lRl4NIY5qDcRrFnl21s57G6XgwovyquyiFquhZgoE%2FBmG930wyBEyxx4pNZEyxzt8%2Brvg%3D%3D&areaCode="+Select.value+"&numOfRows=25&pageNo=1&MobileOS=AND&MobileApp=travel5&_type=json"

            axios.get(base_URL)
                .then(response => {
                    console.log(response.data.response.body.items.item)
                    item = response.data.response.body.items.item
                    item.forEach((sigungu) => {
                        this.selectedlist.push(sigungu)
                    })
                });
            this.selectedlist=[]
        },

        <!--시군구 선택시-->
        changeSigungu : function(){
            var Select = document.getElementById("sigungu");
            alert(Select.value)
            this.sigungucode=Select.value
        },

        <!--체크시 값 출력-->
         check :function(value){
            let base_URL = "http://api.visitkorea.or.kr/openapi/service/rest/KorService/areaBasedList?ServiceKey=tG2pbhauvACu6IO20lRl4NIY5qDcRrFnl21s57G6XgwovyquyiFquhZgoE%2FBmG930wyBEyxx4pNZEyxzt8%2Brvg%3D%3D&contentTypeId="+value+"&areaCode="+this.areacode+"&sigunguCode="+this.sigungucode+"&cat1=&cat2=&cat3=&listYN=Y&MobileOS=ETC&MobileApp=TourAPI3.0_Guide&arrange=A&numOfRows=10&pageNo=1&_type=json"
            this.allSelected=false
            if(this.selectedoption.length!=0){
                for(i in this.selectedoption){
                     if(value==this.selectedoption[i]){
                          this.selectedoption.splice(i,1)
                          this.travelList.splice(i,1)
                     }else{
                        axios.get(base_URL)
                        .then(response => {
                            item = response.data.response.body.items.item
                            item.forEach((travel) => {
                               this.tmplist.push(travel.title)
                            });
                            this.travelList.push(this.tmplist)
                            this.tmplist=[]
                            this.selectedoption.push(item[0].contenttypeid)
                        });
                     }
                }
            }else{
                axios.get(base_URL).then(response => {
                     item = response.data.response.body.items.item
                     item.forEach((travel) => {
                          this.tmplist.push(travel.title)
                     });
                     this.travelList.push(this.tmplist)
                     this.tmplist=[]
                     this.selectedoption.push(item[0].contenttypeid)
                });
            }
         },
         checkAll:function(){
            this.chk_info = [];

            if (!this.allSelected) {
                for (chk in this.kategorie) {
                    this.chk_info.push(this.kategorie[chk].name.toString());
                }
            }
        }
    },
});
Vue.config.devtools = true;

</script>

    <script src="{% static 'maps/assets/js/script.js' %}"></script>

    {% endblock %}