{% extends 'base.html' %}

{% load static %}
{% block css %}<link rel="stylesheet" type="text/css" href="{% static 'maps/stylesheets/MainPage.css' %}"> {% endblock %}

<!-- body -->
{% block body %}
<div class="main-wrapper">
    <!-- section-1 -->
    <div class="section section-1">
        <div class="section-1-background">
            <video style="position: relative;" id="videobcg" preload="auto" autoplay="true" loop="loop" muted="muted" volume="0">
                <source src="{% static 'maps/assets/video/korea.mp4' %}" type="video/mp4">
            </video>
        </div>
        <div class = "section-content">
          <span id="animationSandbox" style="display: block;" class="heartBeat">
             <p style="font-size: 150px" class="site__title mega">Travel To Korea</p>
          </span>
        </div>
    </div>


    <div class="section section-2">
        <div class="section-content">
            <div class="layer" id="app">
                <table class="scrolltable" cellspacing='0' fixed>
                    <colgroup>
                        <col width="30%">
                        <col width="70%">
                    </colgroup>
                    <tr>
                        <div class="checkbox">
                            <td>
                                <input type="checkbox" @click="checkAll" v-model="allSelected">전체
                            </td>
                            <td v-for="i in kategorie"><input type="checkbox" v-model="chk_info" v-on:click="check(i.id)" :value="i.name">[[i.name]]</td>
                        </div>
                    <td>
                        <p>[[chk_info]]</p>
                    </td>
                    </tr>
                    <tr>
                        <td colspan="8">
                            <select id="region" name="region" v-on:change="changeRegion()">
                                <option value="all">전체보기</option>
                                [[selectedlist]]
                                {% for i in value %}
                                <option value="{{i.code}}">{{i.name}}</option>
                                {% endfor %}
                            </select>
                            <select id="sigungu" v-on:change="changeSigungu()">
                                <option  selected disabled hidden>시군구 선택</option>
                                <option v-for="list in selectedlist" id = "listsigungu" :value="list.code">[[list.name]]</option>
                            </select>
                        </td>
                        <td rowspan="2"  height="500" valign="top">
                            <div style="overflow-y:scroll; height:100%; width:100%">
                                <p v-for="list in travelList">[[list]]</p>
                            </div>
                        </td>
                    </tr>
                    <tr >
                        <td colspan="8">
                            {% include 'maps/korea.html' %}
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>

    <div class="section section-3">
        <div class="section-content">
            <!-- To do -->
            <div id="left" style="float: left; width: 45%;">
                <p style="text-align: left; font-size: 25px">왼쪽</p>
                <img src="{% static 'maps/img/left.png' %}" style="width:49%">
            </div>

            <div id="right" style="float: right; width: 50%">
                <p style="text-align: left; font-size: 25px">오른쪽</p>
                <img src="{% static 'maps/img/right.png' %}" style="width:49%">
            </div>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>

var app = new Vue({
    el: '#app',
    delimiters: ['[[', ']]'],
    data: {
            selectedlist:[],
            travelList:[],
            allSelected:false,
            areacode:'',
            sigungucode:'',
            chk_info:[],
            flag:true,
            kategorie:[
                { id : '12', name : '관광'},
                { id : '14', name : '문화'},
                { id : '15', name : '축제'},
                { id : '28', name : '레포츠'},
                { id : '32', name : '숙박'},
                { id : '38', name : '쇼핑'},
                { id : '39', name : '음식'}
            ],
    },
    methods:{
        <!--대분류 선택시-->
        changeRegion : function(){
            var Select = document.getElementById("region");
            this.areacode=Select.value;
            let base_URL = "http://api.visitkorea.or.kr/openapi/service/rest/KorService/areaCode?ServiceKey=tG2pbhauvACu6IO20lRl4NIY5qDcRrFnl21s57G6XgwovyquyiFquhZgoE%2FBmG930wyBEyxx4pNZEyxzt8%2Brvg%3D%3D&areaCode="+Select.value+"&numOfRows=25&pageNo=1&MobileOS=AND&MobileApp=travel5&_type=json"

            axios.get(base_URL)
                .then(response => {
                    console.log(response.data.response.body.items.item)
                    item = response.data.response.body.items.item
                    item.forEach((sigungu) => {
                        this.selectedlist.push(sigungu)
                    })
                });
            this.selectedlist=[]
        },

        <!--시군구 선택시-->
        changeSigungu : function(){
            var Select = document.getElementById("sigungu");
            alert(Select.value)
            this.sigungucode=Select.value
        },
        <!--체크시 값 출력-->
         check :function(value){
            this.allSelected=false
            for(i in this.chk_info){
                if(i.id==value){
                }
            }
            if(this.flag){
                 let base_URL = "http://api.visitkorea.or.kr/openapi/service/rest/KorService/areaBasedList?ServiceKey=tG2pbhauvACu6IO20lRl4NIY5qDcRrFnl21s57G6XgwovyquyiFquhZgoE%2FBmG930wyBEyxx4pNZEyxzt8%2Brvg%3D%3D&contentTypeId="+value+"&areaCode="+this.areacode+"&sigunguCode="+this.sigungucode+"&cat1=&cat2=&cat3=&listYN=Y&MobileOS=ETC&MobileApp=TourAPI3.0_Guide&arrange=A&numOfRows=10&pageNo=1&_type=json"
                 axios.get(base_URL)
                 .then(response => {
                     console.log(response)
                     item = response.data.response.body.items.item

                     item.forEach((travel) => {
                         this.travelList.push(travel.title)
                     });
                     console.log(this.travelList)
                 });
                 this.flag=false
            }else{
                 this.travelList = []
                 this.flag=true
            }
         },
         checkAll:function(){
            this.chk_info = [];

            if (this.allSelected) {
                for (chk in this.kategorie) {
                    this.chk_info.push(this.kategorie[chk].name.toString());
                }
            }
        }
    },
});
Vue.config.devtools = true;

    <!--전체선택-->
      function checkAll(){
        alert("checkall")
          if( $('#chkAll').is(":checked") ){
            $('input:checkbox[name=chk_info]').prop("checked", true);
          }else{
            $('input:checkbox[name=chk_info]').prop("checked", false);
          }
       }

</script>

    {% endblock %}